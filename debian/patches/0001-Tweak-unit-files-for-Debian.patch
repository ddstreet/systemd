From 15e5fff6108630bbbbb6b8adc2f46f9f92517a2a Mon Sep 17 00:00:00 2001
From: Michael Biebl <biebl@debian.org>
Date: Wed, 24 Nov 2010 10:09:31 +0100
Subject: [PATCH 1/3] Tweak unit files for Debian

---
 units/remote-fs.target.m4      |    4 ++--
 units/remount-rootfs.service   |    2 +-
 units/serial-getty@.service.m4 |    2 +-
 units/var-lock.mount           |    2 +-
 5 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/units/remote-fs.target.m4 b/units/remote-fs.target.m4
index f70fda4..1fbc0b7 100644
--- a/units/remote-fs.target.m4
+++ b/units/remote-fs.target.m4
@@ -12,7 +12,7 @@ Description=Remote File Systems
 m4_dnl
 m4_ifdef(`FOR_SYSTEM',
 m4_dnl When running in system mode we need the network up
-After=network.target
+After=network.target local-fs.target
 )m4_dnl
 
 [Install]
diff --git a/units/remount-rootfs.service b/units/remount-rootfs.service
index 3130901..2a3154c 100644
--- a/units/remount-rootfs.service
+++ b/units/remount-rootfs.service
@@ -10,7 +10,7 @@ Description=Remount Root FS
 DefaultDependencies=no
 Conflicts=shutdown.target
 After=systemd-readahead-collect.service systemd-readahead-replay.service fsck-root.service
-Before=local-fs.target shutdown.target
+Before=local-fs.target shutdown.target mountoverflowtmp.service
 
 [Service]
 Type=oneshot
diff --git a/tmpfiles.d/legacy.conf b/tmpfiles.d/legacy.conf
index 9198e89..fe2155d 100644
--- a/tmpfiles.d/legacy.conf
+++ b/tmpfiles.d/legacy.conf
@@ -17,6 +17,6 @@
 # On modern systems a BSD file lock is a better choice if
 # serialization is needed on those devices.
 
-d /run/lock 0755 root root -
+d /run/lock 1777 root root -
 d /run/lock/subsys 0755 root root -
-d /run/lock/lockdev 0775 root lock -
+d /run/lock/lockdev 0775 root root -
diff --git a/units/serial-getty@.service.m4 b/units/serial-getty@.service.m4
index b6ca80b..485a57f 100644
--- a/units/serial-getty@.service.m4
+++ b/units/serial-getty@.service.m4
@@ -32,7 +32,7 @@ Environment=TERM=vt100-nav
 
 [Service]
 Environment=TERM=vt100
-ExecStart=-/sbin/agetty -s %I 115200,38400,9600
+ExecStart=-/sbin/agetty %I 115200,38400,9600
 Restart=always
 RestartSec=0
 UtmpIdentifier=%I
diff --git a/units/getty@.service.m4 b/units/getty@.service.m4
index 8e1f250..d3fcf2c 100644
--- a/units/getty@.service.m4
+++ b/units/getty@.service.m4
@@ -8,7 +8,7 @@
 [Unit]
 Description=Getty on %I
 BindTo=dev-%i.device
-After=dev-%i.device systemd-user-sessions.service plymouth-quit-wait.service
+After=dev-%i.device systemd-user-sessions.service plymouth-quit-wait.service openvpn.service apache2.service
 m4_ifdef(`TARGET_FEDORA',
 After=rc-local.service
 )m4_dnl
